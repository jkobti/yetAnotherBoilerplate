# Kubernetes Secrets Template for Backend API
# Copy this to .env.k8s, fill in your values, then run:
#   make create-secrets
#
# NOTE: .env.k8s is gitignored—never commit actual secrets here.
# For production, use External Secrets Operator or SealedSecrets instead.

# ============================================================================
# DJANGO CORE SETTINGS
# ============================================================================

# DEBUG mode (true for local, false for staging/production)
DEBUG=false

# Secret key for Django (use a strong random value in production)
# Generate: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
SECRET_KEY=change-me-to-a-strong-random-secret-key-in-production

# Comma-separated list of allowed hostnames (no brackets)
# Local: 127.0.0.1,localhost,0.0.0.0,api.local.dev
# Staging: api-staging.example.com,api.staging.example.com
# Production: api.example.com
ALLOWED_HOSTS=api.local.dev,127.0.0.1,localhost

# Enable API documentation (Swagger/ReDoc) - disable in production
API_DOCS_ENABLED=true

# Application Mode
# b2c: Personal workspace auto-created on registration, team features hidden in UI
# b2b: Users must explicitly create/join organizations, full team management UI
APP_MODE=b2c

# ============================================================================
# DATABASE
# ============================================================================

# Default: SQLite (for local/dev only)
#   DATABASE_URL=sqlite:///db.sqlite3
#
# PostgreSQL (recommended for staging/production):
#   DATABASE_URL=postgresql://user:password@hostname:5432/dbname
#   DATABASE_URL=postgresql://postgres:postgres@postgres.apps.svc.cluster.local:5432/backend
#
# See: https://django-environ.readthedocs.io/en/latest/
DATABASE_URL=sqlite:///db.sqlite3

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================

# Email provider: console, smtp, mailgun, postmark, sendgrid, resend
# Local dev: console (logs to stdout)
# Production: resend, sendgrid, or your preferred provider
EMAIL_PROVIDER=console

# Default sender email address
DEFAULT_FROM_EMAIL=no-reply@example.local

# --- Mailgun (optional) ---
# MAILGUN_API_KEY=your-mailgun-api-key
# MAILGUN_DOMAIN=your-mailgun-domain.com

# --- Postmark (optional) ---
# POSTMARK_SERVER_TOKEN=your-postmark-server-token

# --- SendGrid (optional) ---
# SENDGRID_API_KEY=your-sendgrid-api-key

# --- Resend (optional) ---
# RESEND_API_KEY=re_XXXXXXXXXXXXXXXXXXXXXXXXXXXX
# RESEND_SIGNING_SECRET=whsec_XXXXXXXXXXXXXXXXXX   # (optional; only if using webhooks)

# ============================================================================
# CORS SETTINGS
# ============================================================================

# Allow all origins (true for local/dev, false for production)
# Local: true (Flutter dev server on localhost:5173, etc.)
# Production: false (use CORS_ALLOWED_ORIGIN_REGEXES instead)
CORS_ALLOW_ALL_ORIGINS=true

# Comma-separated regex patterns for allowed origins (when CORS_ALLOW_ALL_ORIGINS=false)
# Example: ^https://app\.example\.com$,^https://admin\.example\.com$
CORS_ALLOWED_ORIGIN_REGEXES=

# ============================================================================
# PUSH NOTIFICATIONS (Firebase Cloud Messaging)
# ============================================================================

# Option 1: FCM HTTP v1 via service account JSON file (path or raw JSON)
# GOOGLE_APPLICATION_CREDENTIALS is relative to /app (container workdir)
# or can be an absolute path or raw JSON string (see GOOGLE_SERVICE_ACCOUNT_JSON)

# Path to Firebase service account JSON file (relative to app container workdir)
# In Kubernetes, this would be a file mounted from a Secret volume.
# Example: yetanotherboilerplate-firebase-adminsdk-fbsvc-a8f1ed6c4b.json
GOOGLE_APPLICATION_CREDENTIALS=

# Option 2: Raw Firebase service account JSON (alternative to file)
# Paste the entire JSON object as a single-line string
# Example: {"type":"service_account","project_id":"my-project","private_key":"-----BEGIN PRIVATE KEY-----..."}
GOOGLE_SERVICE_ACCOUNT_JSON=

# Option 3: Legacy FCM Server Key (deprecated, use GOOGLE_SERVICE_ACCOUNT_JSON instead)
FCM_SERVER_KEY=

# ============================================================================
# MAGIC LINK AUTHENTICATION
# ============================================================================

# Resend API key for sending magic link emails
# Only needed if using email-based magic link authentication
RESEND_API_KEY=

# Signing secret for Resend webhooks (optional, leave empty if not using webhooks)
RESEND_SIGNING_SECRET=

# Frontend verification URL where magic link tokens are verified
# REQUIRED: Must be an absolute URL to the frontend route that handles verification
# Local examples:
#   http://localhost:5173
#   http://localhost:5173/auth/magic-verify
#   http://app.local.dev
# Production examples:
#   https://app.example.com
#   https://app.example.com/auth/magic-verify
#
# The code will append /magic-verify?token=... if you supply only the base.
# If you point directly to a page that already ends with /magic-verify, token param is appended directly.
MAGIC_LINK_VERIFY_URL=http://localhost:5173

# Token validity window in minutes (default: 5 minutes for security)
MAGIC_LINK_EXPIRY_MINUTES=5

# Whether to echo the raw token in API responses (DEBUG ONLY—disable in production)
# true: API response includes raw token (convenient for testing)
# false: Token only sent via email
MAGIC_LINK_DEBUG_ECHO_TOKEN=true

# ============================================================================
# REDIS CACHE (optional, for caching and sessions)
# ============================================================================

# Redis connection URL (empty = in-memory cache / no Redis)
# Local: redis://localhost:6379/0
# Kubernetes: redis://redis.apps.svc.cluster.local:6379/0
# Redis with password: redis://:password@redis.apps.svc.cluster.local:6379/0
REDIS_URL=

# ============================================================================
# JWT & AUTHENTICATION
# ============================================================================

# JWT secret key (use a strong random value, can differ from SECRET_KEY)
# Generated same as SECRET_KEY above
JWT_SECRET=

# ============================================================================
# LOGGING
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=info
